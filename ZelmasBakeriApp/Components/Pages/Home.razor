@page "/"
@using ZelmasBakeriApp.Components.Layout
@inject IEmailSender _emailSender;
@inject IConfiguration _config;

@rendermode InteractiveServer

<PageTitle>Forside</PageTitle>

        <div id="wrapper">

			<!-- Main -->
			<div id="main">
				<div class="inner">
					<h1>ZELMAS PETITE PÂTISSERIE</h1>
					<h3>Bakedugnad til inntekt for treningsleir</h3>
					<span class="image main"><img src="images/Forside.jpeg" alt="" /></span>
					<p>👩🏻‍🍳 Hei! Jeg heter Zelma og er 12 år. Jeg elsker å bake kaker, min drøm er å bli konditor.</p>
					<p>🤸‍♀️ Jeg driver med turning på Njård. Jeg trener masse – faktisk 15 timer i uka – og er ofte med på konkurranser.</p>
					<p>💰 For å samle inn penger til treningsleir, arrangerer klubben flere dugnader året rundt. Jeg har derfor begynt å selge hjemmelagde kaker. </p> 
					<p>🍰 Så hvis du vil ha en skikkelig god kake til bursdag, fest eller bare til kos, og samtidig hjelpe turnlaget mitt, er det bare å bestille! </p>

					<p><em>Mine spesialiteter:</em></p>
					<ul>
						<li>Makroner</li>
						<li>Tiramisu</li>
						<li>Gulrotkake</li>
						<li>Jordbærkake med mørk sjokoladekrem</li>
					</ul>
					<p>🛒 Du kan bruke menyen øverst til høyre for å bestille. Når du bestiller, får du en e-post fra meg og så kan vi diskutere ønskene dine, samt avtale leveringsdato og sted.
					Jeg baker vanligvis i helgene, men enda oftere når det er skolefri. :)</p>
					<p>✍️ Likte du kakene mine, blir jeg veldig glad hvis du legger inn en tilbakemelding eller vurdering. </p>
					<p><strong>Sjekk ut kakene mine – håper du finner noe du liker!</strong></p>
				</div>
			</div>

			<!-- Footer -->
			<Footer>
                <h2>Har du spørsmål? Kontakt meg!</h2>
                <EditForm Model="@formData" FormName="ContactForm" OnValidSubmit="@HandleValidSubmit">
                    <DataAnnotationsValidator />
                    <ValidationSummary />
                    <div class="fields">
                        <div class="field">
                            <InputText class="form-control" @bind-Value="formData.Name" placeholder="Ditt navn" type="text" />
                        </div>
                        <div class="field">
                            <InputText class="form-control" @bind-Value="formData.Email" placeholder="Din e-postadresse" type="email" />
                        </div>
                        <div class="field">
                            <InputText class="form-control" @bind-Value="formData.Subject" placeholder="Emne" type="text" />
                        </div>
                        <div class="field">
                            <InputTextArea class="form-control" @bind-Value="formData.Message" placeholder="Melding" />
                        </div>
                    </div>
                    <button type="submit">Send</button>
                </EditForm>
			</Footer>

			
		</div>


@code {
	private FormModel formData = new();

	private async Task HandleValidSubmit()
	{
		var message = ($"<h2>Name: {formData.Name}</h2> <h2>Email: {formData.Email}</h2><p>{formData.Message}</p>");
		var subject = $"[ZELMAS BAKERI] New message from {formData.Name} - {formData.Subject}";
		await _emailSender.SendEmailAsync(_config?.GetValue<string>("EmailSettings:UserName") ?? "zelmasbakeri@gmail.com", subject, message);
		formData.Name = "";
		formData.Email = "";
		formData.Subject = "";
		formData.Message = "";
		StateHasChanged();
	}

    public class FormModel
    {
        public string? Name { get; set; }
        public string? Email { get; set; }
		public string? Subject { get; set; }
		public string? Message { get; set; }
    }
}
